# Oxford Nanopore long read genome assembly and variant analysis of a _Salmonella enterica_ isolate 
## Introduction
_Salmonella enterica_ is a major foodborne pathogen responsible for millions of infections worldwide and poses a significant public health threat due to its genetic diversity, host adaptability, and ability to acquire antimicrobial resistance (1,2). Whole genome sequencing is therefore routinely used to track outbreaks, characterize virulence and resistance determinants, and distinguish closely related strains (1,3). Because _S. enterica_ has a relatively small genome, is well studied, and has many high-quality reference genomes available, it also serves as a useful model for evaluating genome assembly and comparison approaches. 

Modern sequencing technologies fragment DNA and sequence these fragments to produce short or long reads (4). These reads often contain sequencing errors whose frequency and nature vary depending on the platform used. Short-read technologies such as Illumina produce highly accurate reads but struggle to resolve repetitive regions, whereas long-read platforms, including Oxford Nanopore Technologies (ONT) and PacBio, generate much longer reads that can span repeats but historically have higher per-base error rates (5,6). 

Reconstructing a complete genome from these reads therefore requires de novo assembly. Prokaryotic genomes typically consist of a single circular chromosome about a few million base pairs long and may include small extrachromosomal plasmids (7). Obtaining the compete genome sequence of a bacterial isolate is highly valuable in various genomic applications, particularly for comparative analyses such as identifying single nucleotide polymorphisms (SNPs), insertions, deletions, or larger structural differences relative to a reference genome. 

Hybrid genome assembly approaches that integrate both long- and short-read sequencing data are often regarded as the most reliable strategy for producing highly accurate bacterial genomes, as long reads can resolve large-scale genome structure while short reads help correct base-level errors (8). However, hybrid workflows require access to multiple sequencing technologies and introduce additional cost, time, and complexity.

Recent advances in ONT pore chemistry, base calling algorithms, and long-read assembly tools have substantially improved long-read accuracy, making near-complete and high accurate bacterial genome assemblies achievable using ONT data alone (9). Despite these improvements, long-read only assemblies remain prone to several recurring issues, including imperfect circularization of chromosomes, failure to recover or duplication of small plasmids, and the presence of spurious contigs arising from repetitive regions or low-level contamination (10,11). 

The frequency and type of assembly issues can vary depending on the assembler, as different long-read tools handle errors, repeats, and genome complexity in distinct ways (10). Flye is widely used for ONT data due to its robustness, speed, and ability to resolve repetitive regions, though it can occasionally produce imperfect circularization or small assembly artifacts (12). Raven prioritizes computational efficiency and speed, enabling rapid bacterial assemblies, but may be less sensitive in complex repetitive regions (13). Canu incorporates extensive error correction and performs well on noisy long-read data, but it is computationally intensive (14). Trycycler can produce high-quality consensus assemblies by combining multiple assemblies but requires substantial manual intervention (15).  

Consensus assembly pipelines address assembler-specific biases by integrating multiple independent assemblies, allowing consistent sequence features to be distinguished from tool-specific errors. Autocycler is a recently developed pipeline that combines results from multiple long-read assemblers to produce a single final assembly (16). By reducing the need for manual curation compared to approaches like Trycyler, Autocycler is largely automated and user-friendly, making high-quality consensus assemblies from ONT data more accessible. As with any consensus-based methods, the final assembly is still influenced by the quality of the input assemblies, and shared errors or low read depth. To further improve accuracy, assemblies are typically polished with the original ONT reads using tools such as Medaka. This applies neural network-based models trained on ONT data to correct sequencing errors, improving confidence in downstream variant detection. 

Reference-based genome comparison is a powerful approach for identifying genetic variation but has inherent limitations (17,18). Differences between an assembly and the reference may reflect true variation, such as strain-specific mutations or differences in plasmid content but can also arise from assembly errors or reference bias. Regions that are highly divergent, repetitive, or associated with mobile genetic elements may align poorly or be absent from the reference genome, complicating interpretation. The choice of reference strain strongly influences which variants are detected and how they are classified, emphasizing the importance of using a closely related, well-annotated genome. 

Comparisons can be performed using read-based or assembly-based approaches, each with advantages and limitations. In read-based variant calling, raw sequencing reads are aligned to a reference using tools such as minimap2, followed by variant calling with tools such as Snippy. This method accurately detects SNPs and small insertions or deletions when coverage is sufficient and allows inspection in viewers such as IGV.  However, it is sensitive to reference bias and less effective at detecting large structural variants or regions absent from the reference. 

Assembly-based comparisons align the assembled genome to a reference genome and are well suited for detecting large-scale differences in genome structure, including inversions, insertions, deletions, and presence-absence variation. Whole genome alignment tools such as minimal2 or MUMmer can be used, and dot plots or genome alignment visualisations can reveal structural rearrangements. Bandage allows inspection of contig structure and potential misassembles. Because this approach depends on assembly accuracy, residual errors from assembly or polishing may be misinterpreted as true variation. Consequently, combining appropriate comparison strategies with careful visualisation and reference selection is critical for reliable interpretation of genomic differences. 

Overall, the goal of this project is to assemble a high-quality consensus genome of Salmonella enterica using ONT R10 sequencing data, followed by comparison to a publicly available reference genome. Key challenges include managing residual sequencing errors inherent to long-read data, achieving complete genome circularization, and ensuring accurate variant calling when comparing the assembled genome to a reference. The choice of assembler, polishing strategy, and alignment parameters can strongly influence assembly quality and downstream variant detection, highlighting the importance of method selection. 

## Methods
#### Sequencing data acquisition and filtering
Raw Oxford Nanopore R10 sequencing reads for _Salmonella enterica_ were used as input in FASTQ format. Reads were filtered for quality and length using SeqKit v2.12.0 (19) with  a minimum read length (`--min-len`) of 1kb and a minimum Phred score (`--min-qual`) of 20 to retain high-quality reads suitable for assembly. 

#### Genome assembly and polishing
Filtered reads were assembled using using Flye v2.9.6 (12) and optimized for long-read ONT data. Flye was run with the `--nano-hq` option for high-quality ONT reads and `--genome-size 5m` to specify the expected genome size. The assembly was polished using Medaka v2.2.0 with the `--bacteria` model (20). Assembly quality was assessed using QUAST v5.3.0 comparing the polished assembly to the S. enterica reference genome (NCBI ASM694v2) (21). Metrics including number of contigs, total assembly length, N50, number of indels per 100 kb, and missing bases per 100 kb were reported. Contig structure and circularization were further inspected using Bandage v0.9.0 (22). 

#### Variant calling and visualization
The polished assembly in FASTA format will be aligned to the reference genome using MUMmer v4.x (23). Alignment will be performed with the `nucmer` subcommand, specifying` --maxmatch` to identify all maximal exact matches between the assembly and reference. The resulting delta file will be filtered with `delta-filter -1` to retain only one-to-one aligments. SNPs and indels will be extracted from the filtered alignment using `show-snps -Clr`, which reports variant position, reference and query bases, and contextual information. For visualization, both the polished assembly and the reference genome will be loaded into IGV v2.16.0 along with the MUMmer-generated SNP and alignment data (24). This will identify alignment quality, structural rearrangements, and base-level differences between genomes. 

## References
1. Carroll LM, Wiedmann M, Den Bakker H, Siler J, Warchocki S, Kent D, et al. Whole-Genome Sequencing of Drug-Resistant Salmonella enterica Isolates from Dairy Cattle and Humans in New York and Washington States Reveals Source and Geographic Associations. Schaffner DW, editor. Appl Environ Microbiol. 2017 June 15;83(12):e00140-17. 
2.	Li C, Tyson GH, Hsu CH, Harrison L, Strain E, Tran TT, et al. Long-Read Sequencing Reveals Evolution and Acquisition of Antimicrobial Resistance and Virulence Genes in Salmonella enterica. Front Microbiol. 2021 Nov 19;12:777817. 
3.	Song S un, La TM, Kim T, Kim J, Shin E, Temuujin U, et al. Whole-genome sequencing analysis of Salmonella enterica serotype Enteritidis isolated from poultry sources in Mongolia. Front Vet Sci. 2025 May 20;12:1595674. 
4.	Goodwin S, McPherson JD, McCombie WR. Coming of age: ten years of next-generation sequencing technologies. Nat Rev Genet. 2016 June;17(6):333–51. 
5.	Zhang P, Jiang D, Wang Y, Yao X, Luo Y, Yang Z. Comparison of De Novo Assembly Strategies for Bacterial Genomes. IJMS. 2021 July 17;22(14):7668. 
6.	Espinosa E, Bautista R, Larrosa R, Plata O. Advancements in long-read genome sequencing technologies and algorithms. Genomics. 2024 May;116(3):110842. 
7.	Land M, Hauser L, Jun SR, Nookaew I, Leuze MR, Ahn TH, et al. Insights from 20 years of bacterial genome sequencing. Funct Integr Genomics. 2015 Mar;15(2):141–61. 
8.	Wick RR, Judd LM, Holt KE. Assembling the perfect bacterial genome using Oxford Nanopore and Illumina sequencing. Ouellette F, editor. PLoS Comput Biol. 2023 Mar 2;19(3):e1010905. 
9.	Zhao W, Zeng W, Pang B, Luo M, Peng Y, Xu J, et al. Oxford nanopore long-read sequencing enables the generation of complete bacterial and plasmid genomes without short-read sequencing. Front Microbiol. 2023 May 15;14:1179966. 
10.	Boostrom I, Portal EAR, Spiller OB, Walsh TR, Sands K. Comparing Long-Read Assemblers to Explore the Potential of a Sustainable Low-Cost, Low-Infrastructure Approach to Sequence Antimicrobial Resistant Bacteria With Oxford Nanopore Sequencing. Front Microbiol. 2022 Mar 3;13:796465. 
11.	Johnson J, Soehnlen M, Blankenship HM. Long read genome assemblers struggle with small plasmids. Microbial Genomics [Internet]. 2023 May 24 [cited 2026 Jan 18];9(5). Available from: https://www.microbiologyresearch.org/content/journal/mgen/10.1099/mgen.0.001024
12.	Kolmogorov M, Yuan J, Lin Y, Pevzner PA. Assembly of long, error-prone reads using repeat graphs. Nat Biotechnol. 2019 May;37(5):540–6. 
13.	Vaser R, Šikić M. Time- and memory-efficient genome assembly with Raven. Nat Comput Sci. 2021 May 20;1(5):332–6. 
14.	Koren S, Walenz BP, Berlin K, Miller JR, Bergman NH, Phillippy AM. Canu: scalable and accurate long-read assembly via adaptive k -mer weighting and repeat separation. Genome Res. 2017 May;27(5):722–36. 
15.	Wick RR, Judd LM, Cerdeira LT, Hawkey J, Méric G, Vezina B, et al. Trycycler: consensus long-read assemblies for bacterial genomes. Genome Biol. 2021 Dec;22(1):266. 
16.	Wick RR, Howden BP, Stinear TP. Autocycler: long-read consensus assembly for bacterial genomes. Alkan C, editor. Bioinformatics. 2025 Sept 1;41(9):btaf474. 
17.	Kaas RS, Leekitcharoenphon P, Aarestrup FM, Lund O. Solving the Problem of Comparing Whole Bacterial Genomes across Different Sequencing Platforms. Friedrich A, editor. PLoS ONE. 2014 Aug 11;9(8):e104984. 
18.	Sauvage T, Cormier A, Delphine P. A comparison of Oxford nanopore library strategies for bacterial genomics. BMC Genomics. 2023 Oct 20;24(1):627. 
19.	Shen W, Le S, Li Y, Hu F. SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation. Zou Q, editor. PLoS ONE. 2016 Oct 5;11(10):e0163962. 
20.	Medaka [Internet]. GitHub: Oxford Nanopore Technologies; Available from: https://github.com/nanoporetech/medaka
21.	Gurevich A, Saveliev V, Vyahhi N, Tesler G. QUAST: quality assessment tool for genome assemblies. Bioinformatics. 2013 Apr 15;29(8):1072–5. 
22.	Wick RR, Schultz MB, Zobel J, Holt KE. Bandage: interactive visualization of de novo genome assemblies. Bioinformatics. 2015 Oct 15;31(20):3350–2. 
23.	Marçais G, Delcher AL, Phillippy AM, Coston R, Salzberg SL, Zimin A. MUMmer4: A fast and versatile genome alignment system. Darling AE, editor. PLoS Comput Biol. 2018 Jan 26;14(1):e1005944. 
24.	Robinson JT, Thorvaldsdóttir H, Wenger AM, Zehir A, Mesirov JP. Variant Review with the Integrative Genomics Viewer. Cancer Research. 2017 Nov 1;77(21):e31–4. 


